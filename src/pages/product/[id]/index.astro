---
import AppLayout from '../../../layouts/app-layout.astro';
import ImageCarousel from '../../../components/image-carousel/index.astro';
import styles from './styles.module.css';

const params = Astro.params;
const API_HOST = import.meta.env.API_HOST;
const apiUrl = `${API_HOST}/api/products/${params.id}`;

const response = await fetch(apiUrl, {
  method: 'GET',
  headers: {
    'Content-Type': 'application/json',
  },
});

const data = await response.json();
const product = data.product;
console.log(product);
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="generator" content={Astro.generator} />
    <title>Isaju</title>
  </head>
  <body>
    <AppLayout>
      <section class={styles.content}>
        <div class={styles.productContainer}>
          <div class={styles.imageSection}>
            <div class={styles.imageWrapper}>
              <ImageCarousel
                images={product.images}
                alt={product.name}
                variant="detail"
              />
            </div>
          </div>

          <div class={styles.infoSection}>
            <div class={styles.productHeader}>
              <h1 class={styles.productName}>{product.name}</h1>
              <div class={styles.priceContainer}>
                <span class={styles.priceValue}>{product.price}</span>
              </div>
            </div>

            <div class={styles.descriptionSection}>
              <h2 class={styles.sectionTitle}>Descripci√≥n</h2>
              <p class={styles.description}>{product.description}</p>
            </div>

            <div class={styles.actionsSection}>
              <a
                href="https://wa.me/573218524293"
                target="_blank"
                rel="noopener noreferrer"
                class={styles.ctaButton}>
                Contactar por WhatsApp
              </a>
            </div>
          </div>
        </div>
      </section>
    </AppLayout>
  </body>
</html>
